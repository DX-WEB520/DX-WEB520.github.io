<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="小贝壳" href="https://xqlove.xyz/rss.xml"><link rel="alternate" type="application/atom+xml" title="小贝壳" href="https://xqlove.xyz/atom.xml"><link rel="alternate" type="application/json" title="小贝壳" href="https://xqlove.xyz/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="框架,Vue底层原理"><link rel="canonical" href="https://xqlove.xyz/%E4%B8%80%E8%B5%B7%E5%AD%A6%E4%B9%A0Vue%E5%90%A7/"><title>一起学习Vue吧! - Vue | 小贝壳 = Blog</title><meta name="generator" content="Hexo 5.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">一起学习Vue吧!</h1><div class="meta"><span class="item" title="创建时间：2021-03-14 09:24:24"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-03-14T09:24:24+08:00">2021-03-14</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>24k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>21 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">小贝壳</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/wallhaven-13xz11.jpg"></li><li class="item" data-background-image="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/wallhaven-r7qwe1.jpg"></li><li class="item" data-background-image="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/6833939bly1giclxxcb6rj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/10132039_5c3ef2ca68.png"></li><li class="item" data-background-image="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/6833939bly1gipewf5l51j20zk0m8b29.jpg"></li><li class="item" data-background-image="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/3.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Vue/" itemprop="item" rel="index" title="分类于 Vue"><span itemprop="name">Vue</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://xqlove.xyz/%E4%B8%80%E8%B5%B7%E5%AD%A6%E4%B9%A0Vue%E5%90%A7/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="小贝壳"><meta itemprop="description" content="Blog, 你一定会长成自己喜欢的模样"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="小贝壳"></span><div class="body md" itemprop="articleBody"><h1 id="基础篇"><a class="anchor" href="#基础篇">#</a> 基础篇</h1><p>Vue.js 中最核心的部分是视图渲染，从里向外依次是视图层渲染、组件机制、路由机制、状态管理、构建工具。</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"app"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">/*&#123;&#125; 中只可以是变量，不可以是表达式 */</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"item in list"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"item.id"</span><span class="token operator">></span>\<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>swig￼<span class="token number">0</span><span class="token operator">--</span><span class="token operator">></span>\<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"fn(item,$event)"</span><span class="token operator">></span>按钮<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">&lt;</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token comment">/*data 中的属性和 methods 中的属性不能重复 */</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      data<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>          name<span class="token operator">:</span><span class="token string">"123"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>          list<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>              text<span class="token operator">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>              id<span class="token operator">:</span><span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>              text<span class="token operator">:</span><span class="token string">"hi"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>              id<span class="token operator">:</span><span class="token number">2</span></pre></td></tr><tr><td data-num="19"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>              text<span class="token operator">:</span><span class="token string">"welcome"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>              id<span class="token operator">:</span><span class="token number">3</span></pre></td></tr><tr><td data-num="22"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>          <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>              <span class="token comment">// 这里的 this 都是当前实例，不可以写成箭头函数，因为箭头函数不存在 this，若使用 this 需要在上级作用域中查找</span></pre></td></tr><tr><td data-num="27"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr></table></figure><h2 id="vue的优点"><a class="anchor" href="#vue的优点">#</a> Vue 的优点</h2><ul><li>轻量级框架：只关注视图层，是一个构建数据的视图集合，大小只有几十 kb</li><li>简单易学：国人开发，中文文档，易于理解</li><li>采用双向数据绑定：在数据操作方面比较简单</li><li>数据、视图、结构分开：使数据的更改更为简单，不再使用逻辑代码修改数据，只需要直接操作数据就可以完成相关操作。</li><li>组件化：减少代码的冗余，实现了 html 的封装和复用，在构建单页面应用方面有着独特的优势</li><li>虚拟 DOM：DOM 操作非常消耗性能，不再使用原生 DOM 操作节点，提高性能</li><li>运行速度快</li></ul><h2 id="为什么vue组件中data必须是一个函数"><a class="anchor" href="#为什么vue组件中data必须是一个函数">#</a> 为什么 Vue 组件中 data 必须是一个函数</h2><p>保证数据的独立性，对象为引用类型，当复用组件时，由于数据对象都指向同一个 data 对象，当一个组件修改 data 时，其它重用的组件中的 data 也会被修改，而使用返回对象的函数，引用地址不同，不会出现该问题。</p><h2 id="vue指令"><a class="anchor" href="#vue指令">#</a> Vue 指令</h2><p>指令：凡是 <strong>v-</strong> 开头的行内属性，我们都称为 Vue 指令</p><ul><li><p>v-if v-else 之间不可以添加别的指令，v-show 条件为真时显示</p></li><li><p>v-for 循环数组或者对象 v-for=&quot;(item,index) in arr&quot;</p></li><li><p>v-model 相当于 :value 和 @input 合体，常应用于表单和组件中</p></li><li><p>v-on: 事件名 =’函数名‘ 简写 @</p></li><li><p>v-bind = 处理行内属性 简写为：，在行内写变量</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>img<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>/* 属性名是类名，属性值是控制这个类名加不加载，此时name长度为6 >5，则此类名会记载*/</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;active:name.length > 5&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>xxx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">='</span><span class="token attr-value">sty</span><span class="token punctuation">'</span></span><span class="token punctuation">></span></span>加油呀<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    el<span class="token operator">:</span><span class="token string">"app"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    data<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      name<span class="token operator">:</span><span class="token string">"123456"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      img<span class="token operator">:</span><span class="token string">"1.jpg"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      sty<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>          color<span class="token operator">:</span><span class="token string">"red"</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></li><li><p>v-cloak 防止数据不能及时加载，使用方法是在 style 标签中添加<span opacity:0=""> v-cloak</span>。原理：在 Vue 渲染之前为正常的行内属性，opacity:0，所以该标签不显示，当渲染完成时，该指令自动移除，标签正常显示。</p></li><li><p>v-text=&quot;&quot; 显示的是 innerText，文本内容比如标签 h1，初衷是为了解决小胡子问题 {}</p></li><li><p>v-html=“” 会被渲染成 html 标签显示，比如标签 h1 就是将其变成一号标题显示</p></li><li><p>v-once：vue 变量只会渲染一次</p></li><li><p>v-pre：Vue 在编译的时候，直接跳过这个元素，可以提升 Vue 的编译效率</p></li></ul><h3 id="vue初始化页面闪动问题"><a class="anchor" href="#vue初始化页面闪动问题">#</a> Vue 初始化页面闪动问题</h3><p>使用 Vue 开发时，在 Vue 初始化之前，由于 div 是不归 Vue 管的，所以我们写的代码在还没有解析的情况下会容易出现花屏现象，看到类似于 的字样，虽然一般情况下这个时间很短暂，但是我们还是有必要让解决这个问题的。</p><p>首先：在 css 里加上以下代码</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>v<span class="token operator">-</span>cloak<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    display<span class="token operator">:</span> none<span class="token punctuation">;</span><span class="token comment">//opacity:0;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="v-if和v-show的区别"><a class="anchor" href="#v-if和v-show的区别">#</a> v-if 和 v-show 的区别</h3><ul><li>v-if：是惰性的，在条件切换的时候，会对标签进行创建和销毁，条件为真时才会创建标签，有较大的切换开销，有比较小的初始加载开销。</li><li>v-show：初始化的时候加载一次，无论条件是否成立，都会渲染标签，有较大的加载开销，有较小的切换开销，只是简单地控制 display:none 和 block 来改变。</li></ul><h3 id="v-for中为什么要使用key"><a class="anchor" href="#v-for中为什么要使用key">#</a> v-for 中为什么要使用 key</h3><ul><li><p>Key 值是为虚拟 DOM 服务，DOM diff 算法比较两个 DOM 树的不同之处，把不同之处替换，key 值的设定防止两个结构一样但是变量值不同的 DOM 不渲染。</p></li><li><p>理想的 key 应该是数据的唯一的一个 ID 没有的时候我们可以使用索引：缺点 key 具有缓存，有时会导致元素不更新，复用了某老元素。</p></li><li><p>当 Vue 用 v-for 正在更新已渲染过的元素列表时，它默认用 “就地复用” 策略。如果数据项的顺序被改变，Vue 将不是移动 DOM 元素来匹配数据项的改变，而是简单复用此处每个元素，并且确保它在特定索引下显示已被渲染过的每个元素。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name.length&lt;3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    密码&lt;input key=1 type="text" placeholder="密码"</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name.length&lt;3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    年龄&lt;input key=2 type="text" placeholder="年龄"</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>/*</pre></td></tr><tr><td data-num="8"></td><td><pre>    如果我们没有添加key值，就会出现就地复用原则，也就是标签只会改变不同的文本，但是不会加载新的标签。密码框中就可能显示的你输入的年龄的值，年龄框中就有可能显示的你输入的密码的值。</pre></td></tr><tr><td data-num="9"></td><td><pre>*/</pre></td></tr></table></figure></li><li><p>为了给 Vue 一个提示，以便它能跟踪每个节点的身份，从而重用和重新排序现有元素，你需要为每项提供一个唯一 key 属性。key 属性的类型只能为 string 或者 number 类型。</p></li><li><p>key 的特殊属性主要用在 Vue 的虚拟 DOM 算法，在新旧 nodes 对比时辨识 VNodes。如果不使用 key，Vue 会使用一种最大限度减少动态元素并且尽可能的尝试修复 / 再利用相同类型元素的算法。使用 key，它会基于 key 的变化重新排列元素顺序，并且会移除 key 不存在的元素。</p></li></ul><h2 id="vue事件修饰符"><a class="anchor" href="#vue事件修饰符">#</a> Vue 事件修饰符</h2><ul><li>.stop：阻止冒泡</li><li>.prevent：阻止默认事件行为</li><li>.capture：在捕获阶段执行 （事件默认是在冒泡阶段执行）</li><li>.self：仅绑定元素自身触发，只有在点击当前元素的时候才会执行，冒泡传出来的不会执行</li><li>.once：2.1.4 新增，只触发一次</li><li>passive：2.3.0 新增，滚动事件的默认行为 (即滚动行为) 将会立即触发，不能和.prevent 一起使用</li><li>.sync 修饰符：从 2.3.0 起 Vue 重新引入了.sync 修饰符，但是这次它只是作为一个编译时的语法糖存在。它会被扩展为一个自动更新父组件属性的 v-on 监听器，也就是实现了组件的 v-model。</li><li>v-for 和 v-if 尽量不要一起使用，v-for 的优先级高于 v-if，v-if 和 v-else 之间不可以插入其它的标签。</li></ul><h2 id="v-model修饰符"><a class="anchor" href="#v-model修饰符">#</a> v-model 修饰符</h2><ul><li>.lazy：没有 lazy 走的是 input 事件，只要数据发生改变，就会重新渲染，加上 lazy 走的是 change 事件，数据发生改变且光标移出才会发生改变。</li><li>.number：只能在末尾输入数据类型的值，如果输入字符串或者其他类型则不显示</li><li>.trim：自动去除首尾的空格</li></ul><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model.lazy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model.number</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model.trim</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>除此之外还有按键修饰符、鼠标修饰符、系统修饰符，可查阅官方文档查看具体用法。</p><h2 id="todo案例"><a class="anchor" href="#todo案例">#</a> todo 案例</h2><h3 id="如何实现页面刷新数据不丢失"><a class="anchor" href="#如何实现页面刷新数据不丢失">#</a> 如何实现页面刷新数据不丢失？</h3><p>在 Vue 中刷新页面后会重置数组，数据会丢失，我们需要将其存入在 sessionStorage 中。</p><h1 id="组件篇"><a class="anchor" href="#组件篇">#</a> 组件篇</h1><p>组件是可以复用的，但根组件无法复用。单页面开发，只有一个根实例。组件没有使用的时候，我们可以把它理解为一个普通对象，只有在使用的时候才会把这个对象中的配置转成对应的实例。</p><p>全局组件是在 new Vue 之前。工程化不可以使用 template。</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">"my-button"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>Vue-loader 可以把.vue 文件渲染成 HTML、CSS。</p><h2 id="父子组件通信"><a class="anchor" href="#父子组件通信">#</a> 父子组件通信</h2><p>Vue 是双向数据绑定，单向数据流。也就是说父组件传递给子组件的值，子组件是不可以随意修改的，一般父组件中会套很多子组件，如果子组件中修改了值导致父组件发生了修改，就无法确定到底是那个组件的数据发生了修改。</p><h3 id="父传子"><a class="anchor" href="#父传子">#</a> 父传子</h3><p><strong>自定义行内属性 + props</strong></p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>/*父组件*/</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-child</span> <span class="token attr-name">:list</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>ary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-child</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>/*子组件*/</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        props<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'list'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        data<span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="子传父"><a class="anchor" href="#子传父">#</a> 子传父</h3><p><strong>自定义事件 + $emit</strong></p><p>凡是在组件上定义的事件都叫做自定义事件。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>/*父组件*/</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-child</span> <span class="token attr-name">@click</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>fn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-child</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token keyword">return</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                name<span class="token operator">:</span><span class="token string">"parent"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        methods<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>/*子组件*/</pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">return</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                name<span class="token operator">:</span><span class="token string">"child"</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        methods<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="其他的方式"><a class="anchor" href="#其他的方式">#</a> 其他的方式</h2><p>$parent：子组件的属性，可以直接找到父组件的实例</p><p>$children：父组件的属性，可以直接调用到子组件的实例</p><p>这种方式修改没有任何的拦截，父子组件中的数据容易发生混乱</p><h2 id="eventbus"><a class="anchor" href="#eventbus">#</a> eventBus</h2><p>主要用于兄弟组件之间的数据交互。</p><ul><li>bus.$on()</li><li>bus.$off()</li><li>bus.$emit()</li></ul><p><strong>例如：</strong></p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>/*在父组件parents中有两个子组件a、b,a、b组件互为兄弟组件*/</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>//在a组件中</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token comment"></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getAge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>获取年龄<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">return</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            name<span class="token operator">:</span><span class="token string">'xxx'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">"getAge"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> age</pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>//在b组件中</pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token comment"></span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>giveAge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>给年龄<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">return</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            age<span class="token operator">:</span><span class="token string">'18'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    methods：<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      <span class="token function">giveAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>          bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'getAge'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="动态组件"><a class="anchor" href="#动态组件">#</a> 动态组件</h2><p>比如我们在项目中需要动态加载组件时，有时候会用 v-if、v-else，但是当组件比较多的时候可以通过动态组件来加载。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>currentName<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        name<span class="token operator">:</span><span class="token string">'studentb'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token keyword">return</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                currentName<span class="token operator">:</span><span class="token string">"studenta"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        method<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                <span class="token keyword">this</span><span class="token punctuation">.</span>currentName <span class="token operator">=</span> name</pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="keep-alive"><a class="anchor" href="#keep-alive">#</a> keep-alive</h2><p><strong>缓存组件</strong>，例如，现在有一个场景，a、b 组件分别包括一个按钮和文本框，当用户在 a 组件的文本框中输入内容完成后，切换到 b 组件输入，再切换到 a 组件中，会发现 a 组件文本框中的内容为空。解决该问题的方法有两种，①可以将内容存在本地 localStorage 中这种方法比较麻烦，②可以将组件外加上 keep-alive 标签。</p><p>也就是说 <code>keep-alive</code> 可以实现组件缓存，当组件切换时不会对当前组件进行卸载。</p><p>常用的两个属性 <code>include/exclude</code> ，允许组件有条件的进行缓存。</p><p>两个生命周期 <code>activated/deactivated</code> ，用来得知当前组件是否处于活跃状态。</p><p>keep-alive 的中还运用了 <code>LRU(Least Recently Used)</code> 算法。</p><h1 id="路由篇"><a class="anchor" href="#路由篇">#</a> 路由篇</h1><h2 id="如何配置路由"><a class="anchor" href="#如何配置路由">#</a> 如何配置路由</h2><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>//导入 import VueRouter from "v-router"</pre></td></tr><tr><td data-num="2"></td><td><pre>//配置注册</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    path<span class="token operator">:</span><span class="token string">'/'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    name<span class="token operator">:</span><span class="token string">"Home"</span><span class="token punctuation">,</span><span class="token comment">// 非必须</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    redirect<span class="token operator">:</span><span class="token string">'/input'</span><span class="token comment">// 重定向</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    component<span class="token operator">:</span>Home，</pre></td></tr><tr><td data-num="11"></td><td><pre>    chlidren<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span>path<span class="token operator">:</span><span class="token string">'/about'</span><span class="token punctuation">,</span>component<span class="token operator">:</span>Home<span class="token punctuation">&#125;</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    path<span class="token operator">:</span><span class="token string">'/about'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    name<span class="token operator">:</span><span class="token string">'About'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token function-variable function">component</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/*webpackChunkName:"about"（这个注释就是当前模块的名字）*/</span><span class="token string">'../views/About.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// 路由的懒加载 不走到对应路径就不加载</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    meta<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        title<span class="token operator">:</span><span class="token string">"关于页"</span>，</pre></td></tr><tr><td data-num="18"></td><td><pre>        level<span class="token operator">:</span> <span class="token number">0</span> </pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token comment">// 权限配置</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    mode<span class="token operator">:</span><span class="token string">"history"</span><span class="token punctuation">,</span><span class="token comment">//hash history 默认是 hash</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token comment">// 若使用的是 history，是需要后端进行配合的；凡是我们前端设置的路径，去后端请求的时候不要返回 404，返回我们的项目主页即可，因为我们认识这个路径</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    base<span class="token operator">:</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">BASE_URL</span><span class="token punctuation">,</span><span class="token comment">// 也是为了配合后端设置的路径名</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    routes<span class="token comment">// 路由映射表，其实就是一个数组</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>在main<span class="token punctuation">.</span>js中挂载</pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    router<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    store<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token function-variable function">render</span><span class="token operator">:</span><span class="token parameter">h</span> <span class="token operator">=></span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>/input<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>表单<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">/></span></span></pre></td></tr></table></figure><h2 id="路由的两种形式"><a class="anchor" href="#路由的两种形式">#</a> 路由的两种形式</h2><ul><li>history：利用的是 onpopstate 这个事件，采用了 HTML5 中提供的 API 来实现，主要有 <code>history.pushState()</code> 和 <code>history.replaceState()</code> 。会刷新页面。</li><li>hash：利用的 window 下的 onhashchange 这个事件，即地址栏 URL 中的 #符号，hash 虽然出现 URL 中，但不会被包含在 HTTP 请求中，对后端完全没有影响，因此改变 hash 不会重新加载页面。 <code>location.hash</code> 的值实际就是 URL 中 <code>#</code> 后面的东西。</li></ul><p>这两个方法应用于浏览器的历史记录站，在当前已有的 back、forward、go 的基础之上，它们提供了对历史记录进行修改的功能。只是当它们执行修改时，虽然改变了当前的 URL，但浏览器不会立即向后端发送请求。</p><h2 id="路由传递参数的两种方式"><a class="anchor" href="#路由传递参数的两种方式">#</a> 路由传递参数的两种方式</h2><ul><li>query：路由传参。就是问号传参，字符串拼接或者对象的方式，使用 query 方法传入的参数使用 this.$route.query 接收。</li><li>params：路径传参。使用 params 方式传入的参数使用 this.$route.params 接收。需要在 path 中配置好。</li></ul><h2 id="route-和-router有什么区别"><a class="anchor" href="#route-和-router有什么区别">#</a> $route 和 $router 有什么区别</h2><ul><li>router 里面放方法，比如 push、replace、go 方法，想使用编程式导航使用，$router 是 “路由实例” 对象包括了路由的跳转方法，钩子函数等。</li><li>route 里面放属性，是 “路由信息对象”，包括 path，params，hash,query，fullPath，matched，name 等路由信息参数</li></ul><h2 id="push-和-replace有什么区别"><a class="anchor" href="#push-和-replace有什么区别">#</a> push 和 replace 有什么区别</h2><ul><li><p>push 会新增一条历史记录，也就是可以返回上一个跳转的记录</p></li><li><p>replace 只是把当前的路径进行了一个替换，不会新增历史记录。</p></li></ul><h2 id="导航守卫钩子函数"><a class="anchor" href="#导航守卫钩子函数">#</a> 导航守卫钩子函数</h2><ul><li>beforeEach：前置钩子函数，登录校验</li></ul><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span><span class="token keyword">from</span><span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>isLogin<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token comment">// 权限校验</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>useLevel <span class="token operator">&lt;</span> to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>level<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/404'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token comment">// 证明没有登录</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">'/'</span> <span class="token operator">||</span> to<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token comment">// 访问不需要登录的界面</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token comment">// 访问需要登录的页面</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span>     </pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><ul><li>路由独享守卫：beforeEnter</li></ul><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    routes<span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>            path<span class="token operator">:</span> <span class="token string">'/foo'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            component<span class="token operator">:</span> Foo<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token function-variable function">beforeEnter</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span><span class="token keyword">from</span><span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                <span class="token comment">// 给该路由添加的守卫函数</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><ul><li>组件内守卫 (beforeRouterEnter、beforeRouterUpdate、beforeRouterLeave，只有路由的组件才会执行。)<ul><li>beforeRouterEnter：在渲染组件的对应路由被 confirm 前调用，不能获取组件实例 &quot;this&quot;，因为在守卫执行前，组件实例还未被创建。</li><li>beforeRouterUpdate：在当前路由改变，该组件被复用时调用，比如对于携带动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，由于会渲染同样的 Foo 组件，因此组件实例会被复用，钩子函数在此时被调用，可以访问组件实例 this</li><li>beforeRouterLeave：导航离开该组件对应路由时调用，可以访问组件实例 'this',</li></ul></li></ul><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token function">beforeRouterLeave</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span><span class="token keyword">from</span><span class="token punctuation">,</span>next</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token keyword">let</span> bol <span class="token operator">=</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"是否确认离开?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>bol<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="路由懒加载"><a class="anchor" href="#路由懒加载">#</a> 路由懒加载</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/*webpackChunkName:'about'*/</span><span class="token string">'../views/About.vue'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="原理篇"><a class="anchor" href="#原理篇">#</a> 原理篇</h1><h2 id="mvvm原理"><a class="anchor" href="#mvvm原理">#</a> MVVM 原理</h2><h3 id="mvvm介绍"><a class="anchor" href="#mvvm介绍">#</a> MVVM 介绍</h3><ul><li>界⾯框架 WPF ，前端最早的 MVVM 框架 knockout 在 2010 年发布。<ul><li>Model 层：对应数据层的域模型，它主要做域模型的同步。通过 Ajax/fetch 等 API 完成客户端和服务端业务 Model 的同步。在层间关系⾥，它主要⽤于抽象出 ViewModel 中视图的 Model。</li><li>View 层：作为视图模板存在，在 MVVM ⾥，整个 View 是⼀个动态模板。除了定义结构、布局外，它展示的是 ViewModel 层的数据和状态。View 层不负责处理状态，View 层做的是数据绑定的声明、 指令的声明、 事件绑定的声明。</li><li>ViewModel 层：把 View 需要的层数据暴露，并对 View 层的 数据绑定声明、 指令声明、 事件绑定声明 负责，也就是处理 View 层的具体业务逻辑。ViewModel 底层会做好绑定属性的监听。当 ViewModel 中数据变化，View 层会得到更新；⽽当 View 中声明了数据的双向绑定（通常是表单元素），框架也会监听 View 层（表单）值的变化。⼀旦值变化，View 层绑定的 ViewModel 中的数据也会得到⾃动更新。</li></ul></li><li>MVVM 是 <code>Model-View-ViewModel</code> 缩写，也就是把 <code>MVC</code> 中的 <code>Controller</code> 演变成 <code>ViewModel</code> 。Model 层代表数据模型，View 代表 UI 组件，ViewModel 是 View 和 Model 层的桥梁，数据会绑定到 viewModel 层并自动将数据渲染到页面中，视图变化的时候会通知 viewModel 层更新数据。</li></ul><h3 id="手写mvvm"><a class="anchor" href="#手写mvvm">#</a> 手写 MVVM</h3><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 数据劫持</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">// 先判断 data 是否为一个对象</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'[object,Object]'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">let</span> keys <span class="token operator">=</span> object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 获取所有的属性，为了对每一个属性进行劫持</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    keys<span class="token punctuation">.</span><span class="token function">defineReactive$1</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">,</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">function</span> <span class="token function">defineReactive$1</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">let</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 每一个 key 都有它自己的 dep</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    Object<span class="token punctuation">.</span><span class="token function">defineproperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        enumerable<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token comment">// 为什么需要判断？能够触发 get 的方式有很多种，比如在控制台写数据等，所以只有触发了 watcher 实例才会执行这部分代码</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                dep<span class="token punctuation">.</span><span class="token function">addSub</span><span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token comment">// 事件池中放置的都是一些订阅者             </span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token keyword">return</span> val</pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token function">set</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>newVal <span class="token operator">!==</span> val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>               val <span class="token operator">=</span> newVal </pre></td></tr><tr><td data-num="22"></td><td><pre>               dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// 模板编译</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">function</span> <span class="token function">nodeToFragment</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>vm</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token comment">// 把文档上的节点转到了文档碎片上</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">let</span> fragment <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">let</span> child<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>child <span class="token operator">=</span> el<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token comment">//child 是每一个节点，我们需要把每一个节点都编译了</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token function">compile</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        fragment<span class="token punctuation">.</span><span class="token function">appendChile</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    el<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fragment<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">function</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span>vm</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    编译 node 节点：先判断节点的类型，元素节点 | 文本节点元素节点需要考虑行内属性和它的子节点，文本节点直接进行替换即可。</pre></td></tr><tr><td data-num="43"></td><td><pre>    1 (元素) 3 (文本) 8 (注释) 9</pre></td></tr><tr><td data-num="44"></td><td><pre>*/</pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>nodeType <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token comment">// 证明这是一个元素节点</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token keyword">let</span> attrs <span class="token operator">=</span> node<span class="token punctuation">.</span>attributes<span class="token punctuation">;</span><span class="token comment">// 获取是有意的行内属性</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token punctuation">[</span><span class="token operator">...</span>attrs<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token comment">// 我们需要的是 v-xxx 的行内属性 例如:v-model model = "name"</span></pre></td></tr><tr><td data-num="50"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^v-</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>                <span class="token comment">// 证明是 v-model; 我们需要获取对应的值</span></pre></td></tr><tr><td data-num="52"></td><td><pre>                <span class="token keyword">let</span> vName <span class="token operator">=</span> item<span class="token punctuation">.</span>nodeValue<span class="token punctuation">;</span><span class="token comment">//name 这个变量</span></pre></td></tr><tr><td data-num="53"></td><td><pre>                <span class="token keyword">let</span> val <span class="token operator">=</span> vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>vName<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 获取 name 的值</span></pre></td></tr><tr><td data-num="54"></td><td><pre>                <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span>vName<span class="token punctuation">,</span>vm<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>                node<span class="token punctuation">.</span>value <span class="token operator">=</span> val<span class="token punctuation">;</span><span class="token comment">// 把值放入 input 框中</span></pre></td></tr><tr><td data-num="56"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token comment">// 以上处理的是行内属性，还需要考虑子节点</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token punctuation">[</span><span class="token operator">...</span>node<span class="token punctuation">.</span>childNodes<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>            <span class="token comment">// 递归编译子节点</span></pre></td></tr><tr><td data-num="61"></td><td><pre>            <span class="token function">compile</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>vm<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token comment">// 文本节点，需要获取对应的文本字符串，然后把 &#123;&#125; 中的内容转成真实内容</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token keyword">let</span> str <span class="token operator">=</span> node<span class="token punctuation">.</span>textContent<span class="token punctuation">;</span><span class="token comment">//&#123;name&#125;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\&#123;\&#123;(\w+)\&#125;\&#125;</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>            <span class="token comment">// 证明里面有 &#123;&#125;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>            str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\&#123;\&#123;(\w+)\&#125;\&#125;</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>                <span class="token comment">//b ---> name</span></pre></td></tr><tr><td data-num="70"></td><td><pre>                <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span>b<span class="token punctuation">,</span>vm<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre>                <span class="token keyword">return</span> vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span>b<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="72"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>            node<span class="token punctuation">.</span>textContent <span class="token operator">=</span> str<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="77"></td><td><pre></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token comment">// 创造一个订阅器，也就是观察者模式，将数据劫持和模板编译联系起来，</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Dep</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token comment">// 每一个属性都应该有自己的订阅器，比如说变量 name 发生改变时，把使用到 name 的地方重新更新，若 age 发生改变，重新更新 age</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token function">addSub</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>            <span class="token comment">// 负责通知各个事件，sub 就是一些 watcher 实例</span></pre></td></tr><tr><td data-num="90"></td><td><pre>            sup<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token comment">// 创造一个订阅者</span></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Watcher</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span>key<span class="token punctuation">,</span>vm</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span><span class="token comment">//this 就是 watcher 实例</span></pre></td></tr><tr><td data-num="98"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>node <span class="token operator">=</span> node<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> vm<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>        Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>        <span class="token comment">// 负责更新 DOM</span></pre></td></tr><tr><td data-num="106"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">.</span>nodeType <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>            <span class="token comment">// 只考虑 input 框</span></pre></td></tr><tr><td data-num="108"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="111"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>    <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">.</span>$data<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 会触发 get 函数</span></pre></td></tr><tr><td data-num="115"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="117"></td><td><pre></pre></td></tr><tr><td data-num="118"></td><td><pre><span class="token keyword">function</span> <span class="token function">Vue</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>    <span class="token comment">// 私有属性 $el 对应的是我们的 AP 元素</span></pre></td></tr><tr><td data-num="120"></td><td><pre>    <span class="token comment">// 私有属性 $data 对应的是我们传进来的 data</span></pre></td></tr><tr><td data-num="121"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>$el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>option<span class="token punctuation">.</span>el<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="122"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>$data <span class="token operator">=</span> option<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token comment">// 先去劫持数据</span></pre></td></tr><tr><td data-num="124"></td><td><pre>    <span class="token function">observer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token comment">// 负责劫持数据</span></pre></td></tr><tr><td data-num="125"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="双向数据绑定"><a class="anchor" href="#双向数据绑定">#</a> 双向数据绑定</h2><p>Vue 数据双向绑定是通过数据劫持 + 发布订阅模式的方式来实现的。利用了 Object.definePrototype () 这个方法重新定义了对象获取属性值（get) 和设置属性值（set），在 Vue3.0 中采用 proxy。</p><p>** 注意：**Vue.js 目前对状态的侦测策略采用了中等粒度，只通知到组件级别，然后组件使用虚拟 DOM 来渲染视图。</p><h3 id="defineproperty数据劫持"><a class="anchor" href="#defineproperty数据劫持">#</a> defineproperty（数据劫持）</h3><p>Vue 不兼容 IE8，是因为 IE8 不支持 defineproperty。数据劫持是发生在 Vue 初始化的时候。</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/* 此时 name 属性被监听了 */</span></pre></td></tr><tr><td data-num="2"></td><td><pre>Object<span class="token punctuation">.</span><span class="token function">defineproperty</span> <span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"name属性被调用了"</span><span class="token punctuation">)</span><span class="token comment">// 获取 obj.name 的值时，会调用此方法，返回 value，其实也就是 set 中赋的值</span></pre></td></tr><tr><td data-num="5"></td><td><pre>       <span class="token keyword">return</span> value</pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"name属性被赋值了"</span><span class="token punctuation">)</span><span class="token comment">// 为 obj.name 赋值时，会调用此方法，所赋值的值为 val 参数的值</span></pre></td></tr><tr><td data-num="9"></td><td><pre>       value <span class="token operator">=</span> val</pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">/*defineproperty 中的其它属性 */</span></pre></td></tr><tr><td data-num="14"></td><td><pre>obj<span class="token punctuation">.</span><span class="token function">defineproperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">"sex"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    value<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">// 为 sex 变量赋值，此时没有触发 set、get，我们可以在控制台观察到 sex 是灰色的</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    enumerable<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">// 可枚举，此时循环是不可以遍历到的</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    configurable<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">// 可删除，此时 delete.obj.sex 是不可以删除该属性得我</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    writable<span class="token operator">:</span><span class="token boolean">false</span><span class="token comment">// 可写，此时无法改变 sex 的值</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="proxy代理"><a class="anchor" href="#proxy代理">#</a> proxy（代理）</h3><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="2"></td><td><pre>   target: 代理的目标 (此处为 obj)</pre></td></tr><tr><td data-num="3"></td><td><pre>   key: 监听的属性</pre></td></tr><tr><td data-num="4"></td><td><pre>   obj2: 可以理解为 obj 的代理对象</pre></td></tr><tr><td data-num="5"></td><td><pre>*/</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">===</span> target<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">===</span> target<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>val<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val</pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="19"></td><td><pre>   此时我们调用 obj.name 时，它是不触发 get、set 的，只有调用 obj2.name 才会触发。</pre></td></tr><tr><td data-num="20"></td><td><pre>*/</pre></td></tr></table></figure><h3 id="区别"><a class="anchor" href="#区别">#</a> 区别</h3><p>defineproperty 是一个属性一个属性的去监听，proxy 是整个对象的代理。</p><h2 id="说一说数据更新视图不更新的情况vue如何监听对象或数组某个属性的变化"><a class="anchor" href="#说一说数据更新视图不更新的情况vue如何监听对象或数组某个属性的变化">#</a> 说一说数据更新，视图不更新的情况（Vue 如何监听对象或数组某个属性的变化）</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    data<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        name<span class="token operator">:</span><span class="token string">"dx"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        obj<span class="token operator">:</span><span class="token punctuation">&#123;</span>a<span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        ary<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token comment">// 通过.length 或者数组下标更改数组，数组的视图不更新，只有通过 splice pop push unshift shift sort reverse 等方法</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    method<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">666</span><span class="token punctuation">,</span><span class="token comment">//b 是我们新增的一个属性，没有被劫持，所以直接增加一个 b 是不会触发视图更新的。</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>       <span class="token comment">/* fn ()&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            this.obj = &#123;...this.obj,b:666&#125;// 直接更改了 obj 的地址；obj 是被劫持的，所以 obj 一改，视图就更新</pre></td></tr><tr><td data-num="15"></td><td><pre>            this.obj = Object.assign (&#123;b:666&#125;,this.obj)// 将 this.obj 加入 b:666 这个属性，在整体放在 b:666 这个地址中.</pre></td></tr><tr><td data-num="16"></td><td><pre>            this.obj = Object.assign (this.obj,&#123;b:666&#125;)//obj 的地址没有发生改变，因为地址始终是 this.obj 的地址，object.assign () 默认的地址是第一个的地址</pre></td></tr><tr><td data-num="17"></td><td><pre>            </pre></td></tr><tr><td data-num="18"></td><td><pre>          fn ()&#123;</pre></td></tr><tr><td data-num="19"></td><td><pre>             console.log (this.$set)// 利用 Vue 提供的 defineReactive$$1 这个方法，对该目标中的属性进行劫持，defineReactive 本质还是利用了 defineReactive 的 API，也就是 defineProperty 数据劫持原理。</pre></td></tr><tr><td data-num="20"></td><td><pre>             this.$set (this.obj,'b',666)//this.$set (目标，属性名，属性值)</pre></td></tr><tr><td data-num="21"></td><td><pre>          &#125;</pre></td></tr><tr><td data-num="22"></td><td><pre>        &#125;*/</pre></td></tr><tr><td data-num="23"></td><td><pre>            </pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token comment">// 能触发视图更新的哪些变量，一定是被劫持的数据</span></pre></td></tr></table></figure><h2 id="单向数据流"><a class="anchor" href="#单向数据流">#</a> 单向数据流</h2><p>​ 双向数据绑定就是在单向绑定的基础上给可输入元素（input、textare 等）添加了 change (input) 事件，来动态修改 model 和 view，即通过触发（$emit）父组件的事件来修改 mv 来达到 mvvm 的效果。而 vue 组件间传递数据是单向的，即数据总是由父组件传递到子组件，子组件在其内部可以有自己维护的数据，但它无权修改父组件传递给它的数据，当开发者尝试这样做的时候，vue 将会报错。这样做是为了组件间更好的解耦，在开发中可能有多个子组件依赖于父组件的某个数据，假如子组件可以修改父组件数据的话，一个子组件变化会引发所有依赖这个数据的子组件发生变化，所以 vue 不推荐子组件修改父组件的数据，直接修改 props 会抛出警告。</p><h2 id="虚拟dom"><a class="anchor" href="#虚拟dom">#</a> 虚拟 DOM</h2><p><strong>虚拟 DOM 就是用普通的 JS 对象去模拟了真实 DOM。</strong></p><h3 id="什么是vnode"><a class="anchor" href="#什么是vnode">#</a> 什么是 VNode</h3><p>在 Vue.js 中存在一个 VNode 类，使用它可以实例化不同类型的 vnode 实例，而不同类型的 vnode 实例各自表示不同类型的 DOM 元素。vnode 可以理解为 <strong>节点描述对象</strong> ，它描述了应该怎样去创建真实的 DOM。</p><p>渲染视图的过程就是先创建 vnode，然后再使用 vnode 去生成真实 DOM，最后插入到页面渲染视图。</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/* 虚拟 DOM */</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    tag<span class="token operator">:</span>div<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    props<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token keyword">class</span><span class="token punctuation">,</span>id<span class="token operator">...</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    children<span class="token operator">:</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        tag<span class="token operator">:</span><span class="token string">"h1"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        props<span class="token operator">:</span><span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        children<span class="token operator">:</span><span class="token keyword">null</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="vnode的作用"><a class="anchor" href="#vnode的作用">#</a> VNode 的作用</h3><p>我们知道每次渲染视图的时候，都是先创建 vnode，然后再用它生成虚拟 DOM 插入到页面中，所以我们可以将上一次渲染视图所创建的 vnode 缓存起来，之后重新渲染视图的时候，可以将新创建的 vnode 与缓存的的进行比较，看有什么不同，基于此生成 DOM。</p><p>前面我们也提到了，Vue 的状态侦测策略是中等粒度，也就是说组件中一个状态发生改变，整个组件都需要重新渲染，重新渲染整个组件的节点会造成资源的性能浪费，所以对 <strong>vnode 进行缓存</strong> 显得尤为重要。</p><h3 id="vnode的类型"><a class="anchor" href="#vnode的类型">#</a> VNode 的类型</h3><ul><li>注释节点 ： 只有两个有效属性（text、isComment）</li><li>文本节点 ： 只有 text 属性</li><li>元素节点 ：有以下属性（tag：节点名称，例如 div、p；data：节点上的数据，例如 class、style；children：当前节点的子节点列表；context：当前组件的 Vue.js 实例）</li><li>组件节点：与元素节点类似，有两个独有属性（componentOptions、componentInstance)</li><li>函数式节点：与组件节点类似，有两个独有属性（functionalContext、functionalOptions)</li><li>克隆节点 ：将现有节点的属性复制到新节点中，让新创建的节点和被克隆节点的属性保持一致，从而实现克隆效果。它的作用是优化静态节点（内容不会改变）和插槽节点。克隆节点的 isCloned 属性为 true。</li></ul><h3 id="patch"><a class="anchor" href="#patch">#</a> patch</h3><p><strong>Vue 新旧 DOM 在比较的时候，只会同级比较，不会跨级比较。</strong></p><p><strong>虚拟 DOM 中最核心的部分是 pathch</strong>，它可以将虚拟 DOM 转换成真实 DOM。</p><p>之所以我们要采用 patch 是因为 DOM 操作的执行速度远不如 Javascript 的运算速度快，我们把大量的 DOM 操作搬运到 Javascript 中，使用 patching 算法来计算出真正需要更新的节点，能更大限度的减少 DOM 操作，从而显著提升性能。</p><p>patch 不是暴力替换节点，而是在现有的基础上修改 DOM 达到渲染视图的目的：</p><ul><li>创建新增的节点</li><li>删除已经废除的节点</li><li>修改需要更新的节点</li></ul><h4 id="新增节点"><a class="anchor" href="#新增节点">#</a> 新增节点</h4><ol><li>当 oldVnode 不存在，而 vnode 存在时，也就是首次渲染的时候</li><li>当 vnode 和 oldVnode 完全不是同一个节点时，我们是以 vnode 为标准来渲染视图的，所以 vnode 是一个全新的节点，oldVnode 是一个被废弃的节点。</li></ol><h4 id="删除节点"><a class="anchor" href="#删除节点">#</a> 删除节点</h4><ol><li>vnode 中不存在，而 oldVnode 中存在（替换过程是将新节点插入在旧节点的旁边，然后再将旧节点删除）</li></ol><h4 id="更新节点"><a class="anchor" href="#更新节点">#</a> 更新节点</h4><p>我们可以发现在新增节点和删除节点时，vnode 和 oldVnode 是完全不同的两个节点，还有一种常见的场景是新节点和旧节点是同一个节点，这时候我们就需要对两个节点进行比较细致的比对。</p><p>在更新节点时，首先需要判断其是否为静态节点（一旦渲染到界面上之后，无论日后状态如何变化，都不会发生任何变化的节点），如果是直接跳过该节点即可。</p><p><strong>例如：</strong></p><ol><li>两个节点是同一个文本节点，只是文本的内容不一样，我们就需要重置 oldVnode 在视图中所对应的真实 DOM 节点的文本。直接调用 setTextContent 方法即可。</li><li>当 vnode 没有 text 属性时，我们需要判断其是否有 children。<ul><li>若无，则说明 oldVnode 要么是空标签，要么是文本节点，若是文本节点则需要将文本清空，将 vnode 的 children 一个一个创建并插入到视图中。</li><li>若有，则说明它是空节点，oldVnode 中有什么删什么。</li></ul></li></ol><h4 id="更新子节点"><a class="anchor" href="#更新子节点">#</a> 更新子节点</h4><ol><li><p>创建子节点</p><p>新旧两个节点列表是通过循环比较的，所以创建节点的操作是在循环中执行的，具体是在 oldChildren 中中寻找本次循环所指向的新节点。若没有找到，则需要创建节点并插入在未处理的节点前面。</p><p><img data-src="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/%E6%9B%B4%E6%96%B0%E5%AD%90%E8%8A%82%E7%82%B9.jpg" alt=""></p><p>可能你会疑问为什么要插入在未处理的节点前面，插入到已处理的节点后面不行吗？</p><p>答案是不行的，如果这个新节点后面也是一个新增节点呢？</p><p>我们希望插入的位置是如下图所示的，</p><p><img data-src="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/%E6%8F%92%E5%85%A5%E5%88%B0%E6%9C%AA%E5%A4%84%E7%90%86%E8%8A%82%E7%82%B9%E5%89%8D.jpg" alt=""></p><p>如果插入到已处理节点的后面就变成了如下图所示，</p><p><img data-src="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/%E6%8F%92%E5%85%A5%E5%88%B0%E5%B7%B2%E5%A4%84%E7%90%86%E8%8A%82%E7%82%B9%E5%90%8E.jpg" alt=""></p><p><strong>关于新节点插入的位置需要特别注意</strong> 我们是使用虚拟节点进行比对，右下表示已处理的只有两个，不包括新插入的节点，所以如果插入在已处理的节点后面，就会插入到一个错误的位置。</p></li><li><p>更新子节点</p><p>如果两个节点是同一个节点，并且位置相同，则更新即可。</p></li><li><p>移动子节点</p><p>如果位置不相同则需要移动节点，调用 Node.insertBefore () 方法，移动到所有未处理节点的前面即可。</p></li><li><p>删除子节点</p><p>删除在 oldchildren 中存在，newchildren 中不存在的节点即可。</p></li></ol><h4 id="优化策略"><a class="anchor" href="#优化策略">#</a> 优化策略</h4><ol><li><p>新前（newchildren 中未处理的第一个节点）与旧前（oldchildren 中未处理的第一个节点)</p><p>对比是否是同一个节点，若是更新，若不是进行 2</p></li><li><p>新后（newchildren 中未处理的最后一个节点）与旧后（oldchildren 中未处理的最后一个节点)</p><p>对比是否是同一个节点，若是更新，若不是进行 3</p></li><li><p>新后与旧前</p><p>对比是否是同一个节点，若是则更新，由于位置不同则还需要移动到 oldchildren 中所有未处理节点的最后面，若不是进行 4</p></li><li><p>新前与旧后</p><p>对比是否是同一个节点，若是则更新，由于位置不同则还需要移动到 oldchildren 中所有未处理节点的最前面。</p></li></ol><p><strong>进入到循环体内的都是未处理的节点，否则是已处理的节点</strong></p><h2 id="模板编译"><a class="anchor" href="#模板编译">#</a> 模板编译</h2><p>vue 中的模板 template 无法被浏览器解析并渲染，因为这不属于浏览器的标准，不是正确的 HTML 语法，所有需要将 template 转化成一个 JavaScript 函数，这样浏览器就可以执行这一个函数并渲染出对应的 HTML 元素，就可以让视图跑起来了，这一个转化的过程，就成为模板编译。</p><p>模板编译又分三个阶段，解析 parse，优化 optimize，生成 generate，最终生成可执行函数 render。</p><ul><li>parse 阶段：使用大量的正则表达式对 template 字符串进行解析，将标签、指令、属性等转化为抽象语法树 AST。</li><li>optimize 阶段：遍历 AST，找到其中的一些静态节点并进行标记，方便在页面重渲染的时候进行 diff 比较时，直接跳过这一些静态节点，优化 runtime 的性能。</li><li>generate 阶段：将最终的 AST 转化为 render 函数字符串。</li></ul><h3 id="渲染函数"><a class="anchor" href="#渲染函数">#</a> 渲染函数</h3><p>Vue 推荐在绝大多数的情况下使用模板渲染，但是有时候通过模板渲染比较麻烦的情况下，我们通过渲染函数来渲染。比如：在官方文档中通过 level 值判断标签的显示。</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token function-variable function">render</span><span class="token operator">:</span><span class="token parameter">h</span><span class="token operator">=></span><span class="token punctuation">(</span>h<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">"#app"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="api篇"><a class="anchor" href="#api篇">#</a> API 篇</h1><h2 id="vuefilter"><a class="anchor" href="#vuefilter">#</a> Vue.filter</h2><p>过滤器可以有多个。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>app<span class="token punctuation">'</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>&#123;\&#123;num|parse(1,2,3,4)&#125;\&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span> </pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&#123;\&#123;num|parse|qqq&#125;\&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    Vue<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">'parse'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">//val 永远是 |(管道符）前边的表达式或变量对应的值</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token comment">//10000,1,2,3,4</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">(</span>val<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    Vue<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">'qqq'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token comment">//100.00</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">return</span> val<span class="token operator">+</span><span class="token string">'qqq'</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            num<span class="token operator">:</span><span class="token number">10000</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="计算属性和侦听器以及两者的区别"><a class="anchor" href="#计算属性和侦听器以及两者的区别">#</a> 计算属性和侦听器以及两者的区别</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>computed<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">// 计算属性中的属性名不能跟 data 和 methods 中重复</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">//computed data methods props 这四个中的属性 最终都会挂载到当前实例上</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token function">revName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'computed'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token comment">// 依赖 指的是 当前函数体内同步使用的 vue 变量</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token comment">// 在 revName 中 只使用了 this.name; 也就是 只有当 name 发生改变的时候 才会执行该函数</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token comment">// 计算属性的缓存值 说的就是 上次计算结果</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        </pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token comment">// 当我们发现 某些要写的变量 存在依赖关系的时候 我们应当使用 计算属性</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        qqq<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                <span class="token comment">// 上边的这种简写方式 只是相当于 写了一个 get</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                <span class="token comment">//val 就是要设置的那个值</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> val</pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    data<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        name<span class="token operator">:</span><span class="token string">"xxx"</span>，</pre></td></tr><tr><td data-num="33"></td><td><pre>        obj</pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    watch<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token comment">// 监听的属性，都是已经存在的属性</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token function">name</span><span class="token punctuation">(</span><span class="token parameter">newV<span class="token punctuation">,</span>oldV</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>            <span class="token comment">// 死活监听 name 属性，只要 name 发生了改变；这个函数就会执行，不论同异步</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newV<span class="token punctuation">,</span>oldV<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        name<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newV<span class="token punctuation">,</span>oldV</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newV<span class="token punctuation">,</span>oldV<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="45"></td><td><pre>            immediate<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 第一次渲染的时候就执行一次 默认 false</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token comment">//obj()&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            <span class="token comment">// 监听的是 obj 这个变量 里边属性的改变 我们监听不到</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token comment">//console.log(arguments)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        obj<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>            <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newV<span class="token punctuation">,</span>oldV</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>                <span class="token comment">// 深度监听之后，新值和老值是同一个地址</span></pre></td></tr><tr><td data-num="53"></td><td><pre>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newV<span class="token punctuation">,</span>oldV<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="55"></td><td><pre>            deep<span class="token operator">:</span><span class="token boolean">true</span><span class="token comment">// 深度监听</span></pre></td></tr><tr><td data-num="56"></td><td><pre>          <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="计算属性computed"><a class="anchor" href="#计算属性computed">#</a> 计算属性 computed：</h4><ul><li>支持缓存，只有依赖数据发生改变，才会重新进行计算</li><li>不支持异步，当 computed 内有异步操作时无效，无法监听数据的变化</li><li>computed 属性值会默认走缓存，计算属性是基于它们的响应式依赖进行缓存的，也就是基于 data 中声明过或者父组件传递的 props 中的数据通过计算得到的值</li><li>如果一个属性是由其他属性计算而来的，这个属性依赖其他属性，是一个多对一或者一对一，一般用 computed</li><li>如果 computed 属性属性值是函数，那么默认会走 get 方法；函数的返回值就是属性的属性值；在 computed 中的，属性都有一个 get 和一个 set 方法，当数据变化时，调用 set 方法。</li><li>比较适合多对一</li></ul><h4 id="侦听属性watch"><a class="anchor" href="#侦听属性watch">#</a> 侦听属性 watch：</h4><ul><li>不支持缓存，数据变，直接会触发相应的操作；</li><li>watch 支持异步；</li><li>监听的函数接收两个参数，第一个参数是最新的值；第二个参数是输入之前的值；</li><li>当一个属性发生变化时，需要执行对应的操作；一对多；</li><li>监听数据必须是 data 中声明过或者父组件传递过来的 props 中的数据，当数据变化时，触发其他操作，函数有两个参数：</li><li>比较适合一对多</li></ul><blockquote><p>immediate：组件加载立即触发回调函数执行</p></blockquote><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>watch<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  firstName<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newName<span class="token punctuation">,</span> oldName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>fullName <span class="token operator">=</span> newName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">// 代表在 wacth 里声明了 firstName 这个方法之后立即执行 handler 方法</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    immediate<span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>deep: deep 的意思就是深入观察，监听器会一层层的往下遍历，给对象的所有属性都加上这个监听器，但是这样性能开销就会非常大了，任何修改 obj 里面任何一个属性都会触发这个监听器里的 handler</p></blockquote><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>watch<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  obj<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newName<span class="token punctuation">,</span> oldName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'obj.a changed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    deep<span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>优化：我们可以使用字符串的形式监听</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>watch<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token string">'obj.a'</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newName<span class="token punctuation">,</span> oldName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'obj.a changed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">// deep: true</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>这样 Vue.js 才会一层一层解析下去，直到遇到属性 a，然后才给 a 设置监听函数。</p><h3 id="vueuse在什么时候会使用"><a class="anchor" href="#vueuse在什么时候会使用">#</a> Vue.use 在什么时候会使用</h3><p>Vue.use (对象或者一个函数)，若是一个对象，他默认去找里面的 install 方法，若是函数则直接执行函数</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 直接执行函数</span></pre></td></tr><tr><td data-num="2"></td><td><pre>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">_vue</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_vue <span class="token operator">==</span> Vue<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 找到 install 方法执行</span></pre></td></tr><tr><td data-num="6"></td><td><pre>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">_vue</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_vue<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  配置自定义组件，需要配置 index.js 文件，例如:</pre></td></tr><tr><td data-num="13"></td><td><pre>  import button from './button.vue'</pre></td></tr><tr><td data-num="14"></td><td><pre>  import input from './input.vue'</pre></td></tr><tr><td data-num="15"></td><td><pre>*/</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 读取./ 路径下的所有的.vue 后缀的文件；true 代表深层读取；false 代表就读取一层路径</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">const</span> requireComponent <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 显示所有的.vue 文件名</span></pre></td></tr><tr><td data-num="19"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>requireComponent<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">function</span> <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">_vue</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token comment">/*button.name: 在组件 data 中设置 name 属性的值 */</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    _vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span>name<span class="token punctuation">,</span>button<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    _vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>name<span class="token punctuation">,</span>input<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> install</pre></td></tr></table></figure><h3 id="vueuse怎么保证一个插件只执行一次"><a class="anchor" href="#vueuse怎么保证一个插件只执行一次">#</a> Vue.use 怎么保证一个插件只执行一次</h3><p>例如：Vue.use (Vuex) 在源码中如果有就会直接返回。<br>会把之前所有 use 过的插件放在一个数组中，然后每一次执行的时候，先去判断该插件在不在数组中，只要找到该插件就证明之前 use 过，就会执行，不会再向下查找。</p><p><img data-src="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/Vue.use.png" alt=""></p><h2 id="dom的异步更新"><a class="anchor" href="#dom的异步更新">#</a> DOM 的异步更新</h2><p>Dom 的更新是一个异步的操作，往往在 DOM 全部获取完成后再进行一次更新。</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$ref<span class="token punctuation">.</span>box<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token comment">//2</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">this</span><span class="token punctuation">.</span>ary<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$ref<span class="token punctuation">.</span>box<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token comment">//2</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$ref<span class="token punctuation">.</span>box<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token comment">//1</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$ref<span class="token punctuation">.</span>box<span class="token punctuation">.</span>length<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 如果不用箭头函数，需要保证 this，就需要这样写，源码中有相应的处理</span></pre></td></tr></table></figure><h3 id="nexttick"><a class="anchor" href="#nexttick">#</a> nextTick</h3><p>它是为了做出一个异步的操作。利用了事件池，把用户传给 nextTick 的回调函数（实际上在回调函数的基础上又套用了一层函数，为了解决报错和 nextTick 执行），让 pending 变成 true，放完之后让 timeFunc 执行，这个函数里面调用了异步函数，优先使用微任务，没有再使用宏任务，在异步函数中执行了 flushCallbacks，让 pending 变为 false，(nextTick 可能会执行很多次，避免开启其它的异步），让事件池中的所有函数挨个执行，并且清空了事件池。</p><p>pending 作用：第一次执行 nextTick 的时候，吊起了异步（要等同步执行完），也就是下面的 nextTick 调用，不会再开始新的异步，只是向事件池中添加事件。</p><h2 id="vuex"><a class="anchor" href="#vuex">#</a> Vuex</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    state<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token comment">// 放置一些公共的数据</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        count<span class="token operator">:</span><span class="token number">100</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    mutations<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token comment">// 放置一些同步的函数（原则），用来改变数据的方法，这里的方法通过 store.commit (函数名，xxx) 触发，最多两参数，最少一个</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>option</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>            state<span class="token punctuation">.</span>count <span class="token operator">+=</span> option</pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token function">minus</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            state<span class="token punctuation">.</span>count<span class="token operator">--</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    action<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token comment">// 放置一些异步的函数，这里的方法通过 store.dispatch (函数名，xxx) 触发，最多两参数，最少一个</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token function">asyncAdd</span><span class="token punctuation">(</span><span class="token parameter">store<span class="token punctuation">,</span>option</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token comment">//store 就是 new 出来的 vuex 实例，</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span>option<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    modules<span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token comment">// 假如说公用的数据太多，全部堆砌在 state 中显得很乱，此时就可以定义模块。</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="vue生命周期"><a class="anchor" href="#vue生命周期">#</a> Vue 生命周期</h2><p>下图展示了实例的生命周期。你不需要立马弄明白所有的东西，不过随着你的不断学习和使用，它的参考价值会越来越高。&lt;来自官方文档&gt;</p><img data-src="https://cloud-img-1301075855.cos.ap-chengdu.myqcloud.com/xin/lifecycle.png" style="zoom:50%"><ul><li>创建（初始化界面前 / 后）<ul><li>beforeCreate：data 和 el 都没有初始化，无法获得 data 中的数据， <strong>一般使用在第三方插件中</strong>。</li><li>Created：data 已经初始化，但是 $el 还没有初始化，值为 undefined， <strong>可以访问 data 中的数据</strong> ，一般可以用来做一写 AJAX 请求。</li></ul></li><li>载入（渲染 DOM 前 / 后）<ul><li>beforeMount：Vue 实例的 $el 和 data 都初始化了，但还是挂载之前为虚拟 DOM 的节点，data.message 还未替换</li><li>Mounted：Vue 实例挂载完成，可以调用 $el，用 $el 替换 el ，this.$el!=app ，可以获取到真实 DOM 元素 (this.$ref)，echarts、swiper,bmap，data.message 成功渲染</li></ul></li><li>更新（更新数据前 / 后）当能够触发 DOM 更新的数据更改的时候，才会执行这两个函数，不要再更新函数中编写能够触发视图更新的那些操作，会死循环，比如 <span class="exturl" data-url="aHR0cDovL3RoaXMubmFtZQ==">this.name</span> = Math.random()<ul><li>beforeUpdate：响应式数据更新时调用，发生在虚拟 DOM 打补丁之前，适合在更新之前访问现有的 DOM，比如手动移除已添加的事件监听器。数据更新了，视图还未更新。</li><li>Updated：虚拟 DOM 重新渲染和打补丁之后调用，组成新的 DOM 已经更新，避免在这个钩子函数中操作数据，防止死循环。数据视图都更新了。</li></ul></li><li>销毁（卸载组件前 / 后）<ul><li>beforeDestory：实例销毁前，实例还可以用。</li><li>Destoryed：实例销毁后，所有事件监听器会被移除，切断了数据的双向绑定。</li></ul></li></ul><p>对 data 的改变不会再触发周期函数，说明此时 Vue 实例已经解除了事件监听以及和 DOM 的绑定，但是 DOM 结构依然存在。$destory 只是切断了数据层跟视图层的关系，一般用来清除定时器或者原生事件绑定。</p><h3 id="vue-父子组件的生命周期顺序同步"><a class="anchor" href="#vue-父子组件的生命周期顺序同步">#</a> vue 父子组件的生命周期顺序（同步）</h3><p><strong>加载渲染过程</strong></p><p>父 beforeCreate-&gt; 父 created-&gt; 父 beforeMount-&gt; 子 beforeCreate-&gt; 子 created-&gt; 子 beforeMount-&gt; 子 mounted-&gt; 父 mounted</p><p><strong>子组件更新过程</strong></p><p>父 beforeUpdate-&gt; 子 beforeUpdate-&gt; 子 updated-&gt; 父 updated</p><p><strong>父组件更新过程</strong></p><p>父 beforeUpdate-&gt; 父 updated</p><p><strong>销毁过程</strong></p><p>父 beforeDestroy-&gt; 子 beforeDestroy-&gt; 子 destroyed-&gt; 父 destroyed</p><p><strong>异步引入时生命周期顺序：</strong></p><p>父组件的 beforeCreate、created、beforeMount、mounted --&gt; 子组件的 beforeCreate、created、beforeMount、mounted</p><h1 id="vue30"><a class="anchor" href="#vue30">#</a> Vue3.0</h1><ol><li><p>2.x 使用构造函数 <strong>new Vue(...)</strong> 创建实例，3.x 使用 <strong>createApp</strong> 函数创建实例。</p></li><li><p>2.x 所有属性方法和设置都绑定在 <strong>全局 Vue 对象</strong> ，3.x 改为绑定在创建的 <strong>Vue</strong> 实例下。</p></li><li><p>2.x 所有的数据都在 <strong>data</strong> 中定义返回，方法在 <strong>methods</strong> 中，并且可以通过 <strong>this</strong> 调用，3.x 是组合式 API，所有的逻辑代码在 <strong>setup</strong> 中实现，并且 <strong>没有 this</strong> ，setup 方法在生命周期内只执行一次。</p><ul><li>为什么需要使用组合 API：在 2.x 中，碎片化使得理解和维护复杂组件变得困难，选项分离掩盖了潜在的逻辑问题，在处理逻辑的时候需要不断地跳转相关代码选项块。</li></ul></li><li><p>3.x 通过一个新的 <strong>ref</strong> 函数使任何响应式变量在任何地方起作用，它为我们创建了一个响应式引用。</p></li></ol><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span> <span class="token comment">// &#123; value: 0 &#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 0</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>counter<span class="token punctuation">.</span>value<span class="token operator">++</span></pre></td></tr><tr><td data-num="9"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 1</span></pre></td></tr></table></figure><ol start="5"><li>3.x 和 2.x 的 watch 一样，支持 immediate 和 deep 选项，但 3.x 不再支持 obj.key1.key2 的 &quot;点分隔&quot; 写法，3.x 中 watch 支持监听单个属性，也支持监听多个属性，相比 2.x 的 watch 更灵活。</li><li>2.x 中，vue template 只允许有一个根节点，3.x 中，vue template 支持多个根节点。</li><li>为了允许将一些 UI 片段移动到页面中的其他位置，在 Vue3 中添加了一个新的 <strong>teleport</strong> 组件，并且该组件销毁时自动清空相应的 dom，不用人工处理。</li></ol><h1 id="vue-react"><a class="anchor" href="#vue-react">#</a> Vue | React</h1><p>我在搭建项目的时候打算采用 Vue 框架，是因为它的官方文档写的很详细，上手快，建议大家学习的时候多看看官方文档。最后一个 part，就来聊聊和其他框架的对比吧。</p><h2 id="react"><a class="anchor" href="#react">#</a> React</h2><p>这个框架大家应该都不陌生，它有着丰富的生态系统，后期我也打算去接触一下这个框架。</p><p>它跟 Vue 有许多相似之处：</p><ul><li><p>提供了虚拟 DOM</p></li><li><p>提供了响应式和组件化的视图插件</p></li><li><p>注意力集中保持在核心库，将路由和全局管理等交给相关的库</p></li><li><p>运行性能都非常快，都提供了强大路由来应对大型应用</p></li></ul><p>区别：</p><ul><li><p>React 的某个组件状态发生变化时，它会以该组件为根，重新渲染整个组件子树，会有不必要的子组件重渲染，你需要采用手动实现 shouldComponentUpdate 等方式去避免这个问题。使用该方法还需注意，组件的整个子树的渲染输出都是由该组件的 props 所决定的，如果不符合这个情况可能会出现渲染结果与预期不一致的问题。</p><p>Vue 组件的依赖是在渲染过程中自动追踪的，所以系统可以精确地知道哪个组件需要被重新渲染。</p></li><li><p>在 React 中一切都是 Javascript，HTML、CSS 都可以用 Javascript 来处理。所有组件的渲染功能都依靠 JSX（XML 语法编写）。可以理解为 React 偏逻辑。</p><p>Vue 其实也有渲染函数并且支持 JSX，但默认推荐的还是模板，它是合乎 HTML 规范的，对习惯了 HTML 模板的开发者来说，看起来更加自然，将应用迁移到 Vue 更容易。可以理解为 Vue 偏视图。</p></li><li><p>CSS 作用域在 React 中是通过 CSS-in-JS 实现的。Vue 设置样式的默认方法是单文件组件里类似 Style 的标签，可以让你在同一个文件中完全控制 CSS，将其作为组件代码的一部分。</p></li><li><p>React 的路由库和状态管理库是由社区维护的，Vue 是由官方维护的。</p></li></ul><div class="tags"><a href="/tags/%E6%A1%86%E6%9E%B6/" rel="tag"><i class="ic i-tag"></i> 框架</a> <a href="/tags/Vue%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/" rel="tag"><i class="ic i-tag"></i> Vue底层原理</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-03-17 17:40:06" itemprop="dateModified" datetime="2021-03-17T17:40:06+08:00">2021-03-17</time> </span><span id="一起学习Vue吧/" class="item leancloud_visitors" data-flag-title="一起学习Vue吧!" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="小贝壳 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="小贝壳 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>小贝壳 <i class="ic i-at"><em>@</em></i>小贝壳</li><li class="link"><strong>本文链接：</strong> <a href="https://xqlove.xyz/%E4%B8%80%E8%B5%B7%E5%AD%A6%E4%B9%A0Vue%E5%90%A7/" title="一起学习Vue吧!">https://xqlove.xyz/一起学习Vue吧/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/axios/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;cloud-img-1301075855.cos.ap-chengdu.myqcloud.com&#x2F;xin&#x2F;10132039_5c3ef2ca68.png" title="axios"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 数据请求</span><h3>axios</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%AF%87"><span class="toc-number">1.</span> <span class="toc-text">基础篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vue%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">Vue 的优点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88vue%E7%BB%84%E4%BB%B6%E4%B8%ADdata%E5%BF%85%E9%A1%BB%E6%98%AF%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">为什么 Vue 组件中 data 必须是一个函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue%E6%8C%87%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">Vue 指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vue%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B5%E9%9D%A2%E9%97%AA%E5%8A%A8%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.1.</span> <span class="toc-text">Vue 初始化页面闪动问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-if%E5%92%8Cv-show%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.3.2.</span> <span class="toc-text">v-if 和 v-show 的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-for%E4%B8%AD%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8key"><span class="toc-number">1.3.3.</span> <span class="toc-text">v-for 中为什么要使用 key</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue%E4%BA%8B%E4%BB%B6%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="toc-number">1.4.</span> <span class="toc-text">Vue 事件修饰符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#v-model%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="toc-number">1.5.</span> <span class="toc-text">v-model 修饰符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#todo%E6%A1%88%E4%BE%8B"><span class="toc-number">1.6.</span> <span class="toc-text">todo 案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E5%88%B7%E6%96%B0%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%A2%E5%A4%B1"><span class="toc-number">1.6.1.</span> <span class="toc-text">如何实现页面刷新数据不丢失？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%AF%87"><span class="toc-number">2.</span> <span class="toc-text">组件篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">2.1.</span> <span class="toc-text">父子组件通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E4%BC%A0%E5%AD%90"><span class="toc-number">2.1.1.</span> <span class="toc-text">父传子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E4%BC%A0%E7%88%B6"><span class="toc-number">2.1.2.</span> <span class="toc-text">子传父</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">2.2.</span> <span class="toc-text">其他的方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eventbus"><span class="toc-number">2.3.</span> <span class="toc-text">eventBus</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text">动态组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#keep-alive"><span class="toc-number">2.5.</span> <span class="toc-text">keep-alive</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%AF%87"><span class="toc-number">3.</span> <span class="toc-text">路由篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1"><span class="toc-number">3.1.</span> <span class="toc-text">如何配置路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%BD%A2%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text">路由的两种形式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">3.3.</span> <span class="toc-text">路由传递参数的两种方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#route-%E5%92%8C-router%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-number">3.4.</span> <span class="toc-text">$route 和 $router 有什么区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#push-%E5%92%8C-replace%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-number">3.5.</span> <span class="toc-text">push 和 replace 有什么区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0"><span class="toc-number">3.6.</span> <span class="toc-text">导航守卫钩子函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="toc-number">3.7.</span> <span class="toc-text">路由懒加载</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%E7%AF%87"><span class="toc-number">4.</span> <span class="toc-text">原理篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mvvm%E5%8E%9F%E7%90%86"><span class="toc-number">4.1.</span> <span class="toc-text">MVVM 原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mvvm%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.1.1.</span> <span class="toc-text">MVVM 介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%86%99mvvm"><span class="toc-number">4.1.2.</span> <span class="toc-text">手写 MVVM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="toc-number">4.2.</span> <span class="toc-text">双向数据绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#defineproperty%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81"><span class="toc-number">4.2.1.</span> <span class="toc-text">defineproperty（数据劫持）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proxy%E4%BB%A3%E7%90%86"><span class="toc-number">4.2.2.</span> <span class="toc-text">proxy（代理）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB"><span class="toc-number">4.2.3.</span> <span class="toc-text">区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B4%E4%B8%80%E8%AF%B4%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE%E4%B8%8D%E6%9B%B4%E6%96%B0%E7%9A%84%E6%83%85%E5%86%B5vue%E5%A6%82%E4%BD%95%E7%9B%91%E5%90%AC%E5%AF%B9%E8%B1%A1%E6%88%96%E6%95%B0%E7%BB%84%E6%9F%90%E4%B8%AA%E5%B1%9E%E6%80%A7%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">4.3.</span> <span class="toc-text">说一说数据更新，视图不更新的情况（Vue 如何监听对象或数组某个属性的变化）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="toc-number">4.4.</span> <span class="toc-text">单向数据流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9Fdom"><span class="toc-number">4.5.</span> <span class="toc-text">虚拟 DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFvnode"><span class="toc-number">4.5.1.</span> <span class="toc-text">什么是 VNode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vnode%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">4.5.2.</span> <span class="toc-text">VNode 的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vnode%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.5.3.</span> <span class="toc-text">VNode 的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#patch"><span class="toc-number">4.5.4.</span> <span class="toc-text">patch</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E8%8A%82%E7%82%B9"><span class="toc-number">4.5.4.1.</span> <span class="toc-text">新增节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9"><span class="toc-number">4.5.4.2.</span> <span class="toc-text">删除节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%8A%82%E7%82%B9"><span class="toc-number">4.5.4.3.</span> <span class="toc-text">更新节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%AD%90%E8%8A%82%E7%82%B9"><span class="toc-number">4.5.4.4.</span> <span class="toc-text">更新子节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">4.5.4.5.</span> <span class="toc-text">优化策略</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E7%BC%96%E8%AF%91"><span class="toc-number">4.6.</span> <span class="toc-text">模板编译</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E5%87%BD%E6%95%B0"><span class="toc-number">4.6.1.</span> <span class="toc-text">渲染函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#api%E7%AF%87"><span class="toc-number">5.</span> <span class="toc-text">API 篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vuefilter"><span class="toc-number">5.1.</span> <span class="toc-text">Vue.filter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%E5%92%8C%E4%BE%A6%E5%90%AC%E5%99%A8%E4%BB%A5%E5%8F%8A%E4%B8%A4%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">5.2.</span> <span class="toc-text">计算属性和侦听器以及两者的区别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7computed"><span class="toc-number">5.2.0.1.</span> <span class="toc-text">计算属性 computed：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%A6%E5%90%AC%E5%B1%9E%E6%80%A7watch"><span class="toc-number">5.2.0.2.</span> <span class="toc-text">侦听属性 watch：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vueuse%E5%9C%A8%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BC%9A%E4%BD%BF%E7%94%A8"><span class="toc-number">5.2.1.</span> <span class="toc-text">Vue.use 在什么时候会使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vueuse%E6%80%8E%E4%B9%88%E4%BF%9D%E8%AF%81%E4%B8%80%E4%B8%AA%E6%8F%92%E4%BB%B6%E5%8F%AA%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1"><span class="toc-number">5.2.2.</span> <span class="toc-text">Vue.use 怎么保证一个插件只执行一次</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dom%E7%9A%84%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0"><span class="toc-number">5.3.</span> <span class="toc-text">DOM 的异步更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nexttick"><span class="toc-number">5.3.1.</span> <span class="toc-text">nextTick</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vuex"><span class="toc-number">5.4.</span> <span class="toc-text">Vuex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">5.5.</span> <span class="toc-text">Vue 生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vue-%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%A1%BA%E5%BA%8F%E5%90%8C%E6%AD%A5"><span class="toc-number">5.5.1.</span> <span class="toc-text">vue 父子组件的生命周期顺序（同步）</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#vue30"><span class="toc-number">6.</span> <span class="toc-text">Vue3.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vue-react"><span class="toc-number">7.</span> <span class="toc-text">Vue | React</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#react"><span class="toc-number">7.1.</span> <span class="toc-text">React</span></a></li></ol></li></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/%E4%B8%80%E8%B5%B7%E5%AD%A6%E4%B9%A0Vue%E5%90%A7/" rel="bookmark" title="一起学习Vue吧!">一起学习Vue吧!</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="小贝壳" data-src="/images/avatar.jpg"><p class="name" itemprop="name">小贝壳</p><div class="description" itemprop="description">你一定会长成自己喜欢的模样</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">27</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">18</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RYLVdFQjUyMA==" title="https:&#x2F;&#x2F;github.com&#x2F;DX-WEB520"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="aHR0cHM6Ly8xMjI3MzgyNzU5QHFxLmNvbQ==" title="https:&#x2F;&#x2F;1227382759@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>我们</a></li><li class="item"><span class="exturl" data-url="aHR0cHM6Ly9sZWVjdWUueHl6"><i class="ic i-link"></i>开往</span></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/CSS%E5%9F%BA%E7%A1%80/" title="分类于 CSS基础">CSS基础</a></div><span><a href="/CSS%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8%E7%AE%80%E4%BB%8B/" title="CSS预处理器简介">CSS预处理器简介</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Vue/" title="分类于 Vue">Vue</a></div><span><a href="/%E4%B8%80%E8%B5%B7%E5%AD%A6%E4%B9%A0Vue%E5%90%A7/" title="一起学习Vue吧!">一起学习Vue吧!</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSS%E5%9F%BA%E7%A1%80/" title="分类于 CSS基础">CSS基础</a></div><span><a href="/CSS%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%8F%8A%E6%A1%86%E6%9E%B6%E7%AE%80%E4%BB%8B/" title="CSS工程化及框架简介">CSS工程化及框架简介</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/network/" title="分类于 网络">网络</a></div><span><a href="/cookie%E3%80%81localStorage%E3%80%81sessionStorage/" title="cookie、localStorage、sessionStorage">cookie、localStorage、sessionStorage</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/layout/" title="分类于 布局">布局</a></div><span><a href="/%E6%B0%B4%E5%B9%B3%E5%B1%85%E4%B8%AD-%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD/" title="水平居中&amp;垂直居中">水平居中&垂直居中</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/hello-world/" title="Hello World">Hello World</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/layout/" title="分类于 布局">布局</a></div><span><a href="/%E7%AD%89%E5%88%86%E7%AD%89%E9%AB%98%E5%85%A8%E5%B1%8F%E5%A4%9A%E5%88%97%E5%B8%83%E5%B1%80/" title="等分等高全屏多列布局">等分等高全屏多列布局</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSS%E5%9F%BA%E7%A1%80/" title="分类于 CSS基础">CSS基础</a></div><span><a href="/bootstrap%E5%8E%9F%E7%90%86/" title="bootstrap原理">bootstrap原理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/layout/" title="分类于 布局">布局</a></div><span><a href="/CSS%E5%B8%83%E5%B1%80%E6%A8%A1%E5%9E%8B/" title="CSS布局模型">CSS布局模型</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/layout/" title="分类于 布局">布局</a></div><span><a href="/CSS%E5%B8%B8%E8%A7%81%E5%8D%95%E4%BD%8D-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%B8%83%E5%B1%80/" title="CSS常见单位&amp;移动端布局">CSS常见单位&移动端布局</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">小贝壳 @ 小贝壳</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">97k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">1:28</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"一起学习Vue吧/",favicon:{show:"（●´3｀●）欢迎光临",hide:"(´Д｀)确定要离开嘛"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>